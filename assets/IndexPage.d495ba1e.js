import{Q as N}from"./QInnerLoading.0ed0f54f.js";import{af as R,d as $,_ as w,C as u,G as g,H as a,f as i,J as n,N as c,c as q,Q as s,o as L,r as P,M as D,D as I,O as h,K as V}from"./index.5df2bc92.js";import{Q as m}from"./QInput.690d3d89.js";import{Q as k}from"./QTooltip.a007546b.js";import{e as Q,f as B,Q as T}from"./QTable.2ac18fab.js";import{Q as _}from"./QPage.42c487b8.js";import{b as v,c as O,d as M}from"./axios.a63e1254.js";import{Q as f}from"./QCardSection.b73f131f.js";import{Q as b}from"./QSeparator.2cfd8ebb.js";import{Q as C}from"./QImg.8a5b8688.js";import{Q as U}from"./QCardActions.13081c02.js";import{Q as S}from"./QCard.f7479d0b.js";import{Q as F}from"./QFile.53824f1f.js";import{u as G}from"./index.97fe6100.js";import"./use-dark.508530b9.js";import"./format.9eaaa398.js";import"./use-id.0adc5cff.js";import"./uid.42677368.js";import"./use-key-composition.504026ef.js";import"./use-form.1b9f1aa5.js";import"./QList.ff45222d.js";import"./rtl.b51694b1.js";import"./QItem.e09cd2b0.js";import"./QItemLabel.ca6e7a19.js";import"./QCheckbox.471cb50a.js";var j={listequipmentstableloading:!1,retrievedetailspageloading:!1,deleteequipmentitemloading:!1,updateequipmentitemloading:!1,postequipmentitemloading:!1,equipmentitemdialog:!1,equipmenttableindexrows:[],equipmenttableindexcolumns:[{name:"name",label:"Name",field:"name",align:"left"},{name:"type",label:"Type",field:"type",align:"left"},{name:"serial_number",label:"Serial Number",field:"serial_number",align:"left"},{name:"brand",label:"Brand",field:"brand",align:"left"},{name:"location",label:"Location",field:e=>e.location.name,align:"left"},{name:"remarks",label:"Remarks",field:"remarks",align:"left"}],equipmentinputitems:[{name:"name",label:"Name",icon:"",type:"input"},{name:"type",label:"Type",icon:"",type:"input"},{name:"serial_number",label:"Serial Number",icon:"",type:"input"},{name:"brand",label:"Brand",icon:"",type:"input"},{name:"remarks",label:"Remarks",icon:"",type:"input"},{name:"location",label:"Location",icon:"",type:"select"},{name:"image",label:"Name",icon:"",type:"file"}],createequipmentitem:{name:"",type:"",serial_number:"",brand:"",remarks:"",location:null,image:null,imageurl:""},selected:[],equipmentdetailsdialog:!1,equipmentdetailsitem:{name:"",type:"",serial_number:"",brand:"",remarks:"",location:"",image:""},addequipmentdialog:!1};const H=e=>{e.listequipmentstableloading=!0,v.get("equipments/").then(t=>{t.status===200&&(e.equipmenttableindexrows=t.data.results)}).catch(t=>{}).finally(()=>{setTimeout(()=>{e.listequipmentstableloading=!1},1500)})},J=(e,t)=>{e.retrievedetailspageloading=!0,v.get(`equipments/${t}/`).then(o=>{o.status}).catch(o=>{}).then(()=>{e.retrievedetailspageloading=!1})},K=e=>{e.postequipmentitemloading=!0;let t=new FormData;t.append("name",e.createequipmentitem.name),t.append("type",e.createequipmentitem.type),t.append("serial_number",e.createequipmentitem.serial_number),t.append("brand",e.createequipmentitem.brand),t.append("remarks",e.createequipmentitem.remarks),t.append("location",e.createequipmentitem.location),t.append("image",e.createequipmentitem.image),O.post("/equipments/",t).then(o=>{o.status===201&&e.equipmenttableindexrows.unshift(o.data)}).catch(o=>{console.log(o)}).finally(()=>{e.createequipmentitem={name:"",type:"",serial_number:"",brand:"",remarks:"",location:null,image:null,imageurl:""},e.postequipmentitemloading=!1,e.addequipmentdialog=!1})},z=(e,t)=>{v.get(`equipments-search/?name=${t}&location`).then(o=>{o===200&&console.log(o)}).catch(o=>{console.log(o)}).finally(()=>{console.log("Close")})},W=(e,t)=>{e.equipmentdetailsdialog=!0,e.equipmentdetailsitem.name=t.name,e.equipmentdetailsitem.type=t.type,e.equipmentdetailsitem.serial_number=t.serial_number,e.equipmentdetailsitem.brand=t.brand,e.equipmentdetailsitem.remarks=t.remarks,e.equipmentdetailsitem.location=t.location.name,e.equipmentdetailsitem.image=t.image},X=e=>{e.equipmentdetailsitem={name:"",type:"",serial_number:"",brand:"",remarks:"",location:"",image:""},e.equipmentdetailsdialog=!1},Y=e=>{e.addequipmentdialog=!0},Z=e=>{e.createequipmentitem={name:"",type:"",serial_number:"",brand:"",remarks:"",location:null,image:null,imageurl:""},e.addequipmentdialog=!1},x=(e,t)=>{e.deleteequipmentitemloading=!0,v.delete(`equipments/${t}/`).then(o=>{if(o.status===204){let r=e.equipmenttableindexrows.findIndex(d=>d.id===t);e.equipmenttableindexrows.splice(r,1),e.selected=[]}}).catch(o=>{console.log(o)}).finally(()=>{setTimeout(()=>{e.deleteequipmentitemloading=!1},1500)})},y=R("equipments",{state:()=>j,getters:{equipmentItems:e=>e.equipmenttableindexrows.map(t=>({id:t.id,name:t.name,type:t.type,serial_number:t.serial_number,brand:t.brand,remarks:t.remarks,location:t.location.name,image:`${M.baseUrl}${t.image}`,created_at:t.created_at})),equipmentOptions:e=>e,hasSelected:e=>e.selected.length>0},actions:{getAllItems(){H(this)},getEquipmentItem(e){J(this,e.id)},postEquipmentItem(){K(this)},searchEquipmentItem(e){z(this,e)},openEquipmentDetailsDialog(e){W(this,e)},closeEquipmentDetailsDialog(){X(this)},openAddEquipmentItemDialog(){Y(this)},closeAddEquipmentItemDialog(){Z(this)},deleteEquipmentItem(e){x(this,e)}}}),ee=$({name:"equipmentdetails",setup(){return{equipmentstore:y()}}}),te=n("h6",null,"Equipment Details Page",-1),ie={class:"row items-center"},le={class:"col q-pa-sm"},ne={class:"row items-center"},ae={class:"col q-pa-sm"},oe={class:"row items-center"},me={class:"col q-pa-sm"},se={class:"row items-center"},re={class:"col q-pa-sm"},de={class:"row items-center"},pe={class:"col q-pa-sm"},ue={class:"row items-center"},ce={class:"col q-pa-sm"},qe={class:"row items-center"},ge={class:"col q-pa-sm"};function fe(e,t,o,r,d,E){return u(),g(_,{class:"q-pa-sm"},{default:a(()=>[i(Q,{modelValue:e.equipmentstore.equipmentdetailsdialog,"onUpdate:modelValue":t[7]||(t[7]=l=>e.equipmentstore.equipmentdetailsdialog=l),"backdrop-filter":"blur(4px)",persistent:""},{default:a(()=>[i(S,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[i(f,null,{default:a(()=>[te]),_:1}),i(b),i(f,{class:"scroll"},{default:a(()=>[n("div",ie,[n("div",le,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.equipmentstore.equipmentdetailsitem.name=l),label:"Name",readonly:""},null,8,["modelValue"])])]),n("div",ne,[n("div",ae,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.type,"onUpdate:modelValue":t[1]||(t[1]=l=>e.equipmentstore.equipmentdetailsitem.type=l),label:"Type",readonly:""},null,8,["modelValue"])])]),n("div",oe,[n("div",me,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.serial_number,"onUpdate:modelValue":t[2]||(t[2]=l=>e.equipmentstore.equipmentdetailsitem.serial_number=l),label:"Serial Number",readonly:""},null,8,["modelValue"])])]),n("div",se,[n("div",re,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.brand,"onUpdate:modelValue":t[3]||(t[3]=l=>e.equipmentstore.equipmentdetailsitem.brand=l),label:"Brand",readonly:""},null,8,["modelValue"])])]),n("div",de,[n("div",pe,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.remarks,"onUpdate:modelValue":t[4]||(t[4]=l=>e.equipmentstore.equipmentdetailsitem.remarks=l),label:"Remarks",readonly:""},null,8,["modelValue"])])]),n("div",ue,[n("div",ce,[i(m,{modelValue:e.equipmentstore.equipmentdetailsitem.location,"onUpdate:modelValue":t[5]||(t[5]=l=>e.equipmentstore.equipmentdetailsitem.location=l),label:"Location",readonly:""},null,8,["modelValue"])])]),n("div",qe,[n("div",ge,[i(C,{src:e.equipmentstore.equipmentdetailsitem.image,"spinner-color":"white",style:{height:"140px","max-width":"150px"}},null,8,["src"])])])]),_:1}),i(b),i(U,{align:"left"},{default:a(()=>[i(c,{outline:"",label:"Close",color:"red",onClick:t[6]||(t[6]=l=>e.equipmentstore.closeEquipmentDetailsDialog())})]),_:1})]),_:1})]),_:1},8,["modelValue","backdrop-filter"])]),_:1})}var be=w(ee,[["render",fe]]);const ve=$({name:"addequipment",setup(){const e=y(),t=G(),o=q(()=>e.createequipmentitem);return{equipmentstore:e,locationstore:t,createequipmentitem:o}},methods:{onSelected(){this.createequipmentitem.image!=null?this.createequipmentitem.imageurl=window.URL.createObjectURL(this.createequipmentitem.image):this.createequipmentitem.imageurl=null}}}),he=n("h6",null,"Add Equipment Item",-1),Ve={class:"row items-center"},ke={class:"col q-pa-sm"},$e={class:"row items-center"},we={class:"col q-pa-sm"},_e={class:"row items-center"},ye={class:"col q-pa-sm"},Ee={class:"row items-center"},De={class:"col q-pa-sm"},Ie={class:"row items-center"},Qe={class:"col q-pa-sm"},Ce={class:"row items-center"},Ue={class:"col q-pa-sm"},Se={class:"row items-center"},Ae={class:"col q-pa-sm"},Ne={class:"row items-center"},Re={class:"col q-pa-sm"};function Le(e,t,o,r,d,E){return u(),g(_,{class:"q-pa-sm"},{default:a(()=>[i(Q,{modelValue:e.equipmentstore.addequipmentdialog,"onUpdate:modelValue":t[10]||(t[10]=l=>e.equipmentstore.addequipmentdialog=l),"backdrop-filter":"blur(4px)",persistent:""},{default:a(()=>[i(S,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[i(f,null,{default:a(()=>[he]),_:1}),i(b),i(f,{class:"scroll"},{default:a(()=>[n("div",Ve,[n("div",ke,[i(m,{label:"Name",filled:"",modelValue:e.createequipmentitem.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.createequipmentitem.name=l)},{prepend:a(()=>[i(s,{name:"badge"})]),_:1},8,["modelValue"])])]),n("div",$e,[n("div",we,[i(m,{label:"Type",filled:"",modelValue:e.createequipmentitem.type,"onUpdate:modelValue":t[1]||(t[1]=l=>e.createequipmentitem.type=l)},{prepend:a(()=>[i(s,{name:"text_format"})]),_:1},8,["modelValue"])])]),n("div",_e,[n("div",ye,[i(m,{label:"Serial Number",filled:"",modelValue:e.createequipmentitem.serial_number,"onUpdate:modelValue":t[2]||(t[2]=l=>e.createequipmentitem.serial_number=l)},{prepend:a(()=>[i(s,{name:"tag"})]),_:1},8,["modelValue"])])]),n("div",Ee,[n("div",De,[i(m,{label:"Brand",filled:"",modelValue:e.createequipmentitem.brand,"onUpdate:modelValue":t[3]||(t[3]=l=>e.createequipmentitem.brand=l)},{prepend:a(()=>[i(s,{name:"branding_watermark"})]),_:1},8,["modelValue"])])]),n("div",Ie,[n("div",Qe,[i(m,{label:"Remarks",filled:"",modelValue:e.createequipmentitem.remarks,"onUpdate:modelValue":t[4]||(t[4]=l=>e.createequipmentitem.remarks=l)},{prepend:a(()=>[i(s,{name:"task"})]),_:1},8,["modelValue"])])]),n("div",Ce,[n("div",Ue,[i(B,{label:"Location",filled:"",options:e.locationstore.locationOptions,"map-options":"","emit-value":"",modelValue:e.createequipmentitem.location,"onUpdate:modelValue":t[5]||(t[5]=l=>e.createequipmentitem.location=l)},{prepend:a(()=>[i(s,{name:"map",color:"black"})]),_:1},8,["options","modelValue"])])]),n("div",Se,[n("div",Ae,[i(F,{modelValue:e.createequipmentitem.image,"onUpdate:modelValue":[t[6]||(t[6]=l=>e.createequipmentitem.image=l),t[7]||(t[7]=l=>e.onSelected())],label:"Image",clearable:"",filled:""},{prepend:a(()=>[i(s,{name:"attach_file"})]),_:1},8,["modelValue"])])]),n("div",Ne,[n("div",Re,[i(C,{src:e.createequipmentitem.imageurl,"spinner-color":"black",style:{height:"140px","max-width":"150px"}},null,8,["src"])])])]),_:1}),i(b),i(U,{align:"left"},{default:a(()=>[i(c,{outline:"",label:"Close",color:"red",onClick:t[8]||(t[8]=l=>e.equipmentstore.closeAddEquipmentItemDialog())}),i(c,{outline:"",label:"Save",color:"blue",loading:e.equipmentstore.postequipmentitemloading,onClick:t[9]||(t[9]=l=>e.equipmentstore.postEquipmentItem())},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","backdrop-filter"])]),_:1})}var Pe=w(ve,[["render",Le]]);const Be=$({name:"equipments",setup(){const e=y(),t=q(()=>e.equipmenttableindexcolumns),o=q(()=>e.equipmenttableindexrows),r=q({get:()=>e.selected,set:d=>e.selected=d});return L(()=>e.getAllItems()),{equipmentstore:e,equipmenttableindexcolumns:t,equipmenttableindexrows:o,selected:r,indextablefilter:P("")}},methods:{onRowClick(e,t,o){this.equipmentstore.openEquipmentDetailsDialog(t)},clickRemoveItem(){console.log(this.selected),this.equipmentstore.deleteEquipmentItem(this.selected[0].id)}},components:{EquipmentDetailsDialogPage:be,AddEquipmentDialog:Pe}}),Te={class:"row items-center"},Oe={class:"col items-center"},Me={class:"row"},Fe={key:0},Ge={key:1};function je(e,t,o,r,d,E){const l=D("EquipmentDetailsDialogPage"),A=D("AddEquipmentDialog");return u(),g(_,{class:"q-pa-sm"},{default:a(()=>[n("div",Te,[n("div",Oe,[n("div",Me,[e.$q.platform.is.desktop?(u(),I("h2",Fe,"Equipment Management")):h("",!0),e.$q.platform.is.mobile?(u(),I("h6",Ge,"Equipment Management")):h("",!0)])])]),i(T,{title:"Equipment List","auto-width":"",flat:"",bordered:"","row-key":"id",selection:"single",selected:e.selected,"onUpdate:selected":t[4]||(t[4]=p=>e.selected=p),filter:e.indextablefilter,separator:"vertical",columns:e.equipmenttableindexcolumns,rows:e.equipmenttableindexrows,loading:e.equipmentstore.listequipmentstableloading,onRowClick:e.onRowClick},{loading:a(()=>[i(N,{showing:"",color:"primary"})]),"top-right":a(()=>[i(m,{class:"q-mr-sm",dense:"",debounce:"500",modelValue:e.indextablefilter,"onUpdate:modelValue":t[0]||(t[0]=p=>e.indextablefilter=p),placeholder:"Search",outlined:""},{append:a(()=>[i(s,{name:"search"})]),_:1},8,["modelValue"]),i(c,{class:"q-mr-sm",color:"primary",icon:"add",onClick:t[1]||(t[1]=p=>e.equipmentstore.openAddEquipmentItemDialog())},{default:a(()=>[i(k,{class:"bg-accent"},{default:a(()=>[V("Add Item")]),_:1})]),_:1}),e.equipmentstore.hasSelected?(u(),g(c,{key:0,class:"q-mr-sm",color:"primary",icon:"remove",loading:e.equipmentstore.deleteequipmentitemloading,onClick:t[2]||(t[2]=p=>e.clickRemoveItem())},{default:a(()=>[i(k,{class:"bg-accent"},{default:a(()=>[V("Remove Item")]),_:1})]),_:1},8,["loading"])):h("",!0),i(c,{class:"q-mr-sm",color:"primary",icon:"sync",onClick:t[3]||(t[3]=p=>e.equipmentstore.getAllItems())},{default:a(()=>[i(k,{class:"bg-accent"},{default:a(()=>[V("Get Latest Data")]),_:1})]),_:1})]),_:1},8,["selected","filter","columns","rows","loading","onRowClick"]),i(l),i(A)]),_:1})}var ft=w(Be,[["render",je]]);export{ft as default};
