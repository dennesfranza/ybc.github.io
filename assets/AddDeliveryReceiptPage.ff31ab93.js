import{d as C,c as a,_ as V,C as k,D as G,f as i,H as t,Q as y,N as n,J as d,r as u,M as q,G as D,K as f,g as L,x as j,O as U}from"./index.7c7b8282.js";import{Q as R}from"./QInput.321b8eed.js";import{e as A,f as w,Q as O}from"./QTable.a5502490.js";import{Q as z,a as E}from"./QPopupProxy.db37d52e.js";import{Q as h}from"./QTooltip.574840fb.js";import{Q as I}from"./QPage.9773e727.js";import{C as J}from"./ClosePopup.c5e1e30c.js";import{u as K,F as W}from"./FormHeader.bdc211c4.js";import{u as $}from"./index.e710950d.js";import{u as X}from"./index.e2cb4afa.js";import{u as Y}from"./index.657cef26.js";import{u as Z}from"./index.aa89ca5c.js";import{u as B}from"./index.d49a9c05.js";import{Q as _}from"./QCardSection.7cfc943c.js";import{Q as g}from"./QSeparator.7443f346.js";import{Q as x,a as ee}from"./QItem.09a728d7.js";import{Q as S}from"./QCardActions.3b0fd6c6.js";import{Q as N}from"./QCard.fd6c76dc.js";import{u as re}from"./index.018cca22.js";import"./use-key-composition.a804c2f6.js";import"./use-dark.f1ed3aaa.js";import"./use-id.52264d24.js";import"./uid.42677368.js";import"./use-form.8f60a875.js";import"./QList.51621a8d.js";import"./rtl.b51694b1.js";import"./QItemLabel.b8289c17.js";import"./format.65a6df85.js";import"./QCheckbox.8583a2e3.js";import"./use-cache.b0833c75.js";import"./date.f405f89b.js";import"./use-quasar.0035955d.js";import"./axios.56601fbe.js";const ie=C({name:"adddeliveryreceiptquantityremarks",setup(){const e=$(),r=a(()=>e.deliveryreceiptaddquantityremarksdialog),s=a(()=>e.delivery_receipt_item);return{deliverystore:e,deliveryreceiptaddquantityremarksdialog:r,delivery_receipt_item:s}}}),te={class:"q-pa-md q-gutter-sm"},se=d("div",{class:"h6"},"Add Quantity and Remarks",-1);function oe(e,r,s,v,c,m){return k(),G("div",te,[i(A,{modelValue:e.deliveryreceiptaddquantityremarksdialog,"onUpdate:modelValue":r[4]||(r[4]=o=>e.deliveryreceiptaddquantityremarksdialog=o)},{default:t(()=>[i(N,{style:{width:"450px",height:"320px"}},{default:t(()=>[i(_,null,{default:t(()=>[se]),_:1}),i(g),i(_,null,{default:t(()=>[i(R,{class:"q-mr-sm",modelValue:e.delivery_receipt_item.quantity,"onUpdate:modelValue":r[0]||(r[0]=o=>e.delivery_receipt_item.quantity=o),dense:"",debounce:"500",outlined:"",label:"Quantity",type:"number"},{prepend:t(()=>[i(y,{name:"123"})]),_:1},8,["modelValue"]),i(R,{class:"q-mr-sm",modelValue:e.delivery_receipt_item.remarks,"onUpdate:modelValue":r[1]||(r[1]=o=>e.delivery_receipt_item.remarks=o),dense:"",debounce:"500",outlined:"",label:"Remarks"},{prepend:t(()=>[i(y,{name:"description"})]),_:1},8,["modelValue"])]),_:1}),i(g),i(S,null,{default:t(()=>[i(n,{outline:"",label:"Close",color:"red",onClick:r[2]||(r[2]=o=>e.deliverystore.closeQuantityRemarksDialog())}),i(n,{outline:"",label:"Add",color:"blue",onClick:r[3]||(r[3]=o=>e.deliverystore.addDeliveryItem())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var le=V(ie,[["render",oe]]);const ae=C({name:"adddeliveryreceipt",setup(){const e=$(),r=B(),s=re(),v=a(()=>e.delivery_receipt_item),c=a(()=>e.deliveryreceiptdialog),m=a(()=>e.deliveryreceiptsearchcolumns),o=a(()=>e.deliveryreceiptsearchrows),b=a(()=>e.deliveryreceiptsearchtableloading),p=a(()=>r.requisitiondetails),l=a(()=>r.requisitiondetailsitems),Q=a(()=>e.deliveryreceiptpayload);return{deliverystore:e,requisitionstore:r,consumablestore:s,delivery_receipt_item:v,deliveryreceiptdialog:c,deliveryreceiptsearchcolumns:m,deliveryreceiptsearchrows:o,deliveryreceiptsearchtableloading:b,requisitiondetails:p,requisitiondetailsitems:l,deliveryreceiptpayload:Q,rsnumberoptions:u([]),consumableoptions:u([])}},methods:{closeDialog(){this.requisitionstore.requisitiondetailsitems=[],this.deliverystore.closeAddDeliveryDialog()},addItems(){let e=this.requisitiondetailsitems.map(r=>({quantity:r.quantity,description:r.description.id,description_label:r.description.name,rs_number:this.requisitiondetails.id,rs_number_label:this.requisitiondetails.rs_number,remarks:""}));this.deliveryreceiptpayload.delivery_receipt_items=this.deliveryreceiptpayload.delivery_receipt_items.concat(e),this.requisitionstore.requisitiondetailsitems=[],this.deliverystore.closeAddDeliveryDialog()},onRowClick(e,r,s){this.delivery_receipt_item.rs_number=r.rs_number,this.delivery_receipt_item.rs_number_label=r.rs_number_label,this.delivery_receipt_item.description_label=r.description_label,this.delivery_receipt_item.description=r.description,this.deliverystore.openQuantityRemarksDialog()},filterConsumableItem(e,r,s){r(()=>{e===""?this.consumableoptions=u([]):this.consumablestore.searchConsumable(e)})},updateDeliveryModel(e){e!=null&&(this.requisitionstore.retrieveRequisitionItem(e),this.deliverystore.deliveryreceiptpayload.delivery_receipt_items.rs_number=e,this.deliverystore.deliveryreceiptpayload.delivery_receipt_items.rs_number_label=this.requisitionstore.requisitiondetails.rs_number)},filterRsNumber(e,r,s){r(()=>{e===""?this.rsnumberoptions=u([]):e.length>=2&&this.requisitionstore.searchRsNumber(e)})},updateRsNumberModel(e){this.delivery_receipt_item.rs_number_label=e;let r=this.requisitionstore.rsnumbersearchresults.find(s=>s.id===e);this.deliverystore.delivery_receipt_item.rs_number_label=r.rs_number},updateConsumableModel(e){this.delivery_receipt_item.description_label=e;let r=this.consumablestore.consumablesearchresults.find(s=>s.id===e);this.deliverystore.delivery_receipt_item.description_label=r.name}},components:{AddDeliveryReceiptQuantityRemarksDialog:le}}),de=d("h6",null,"Delivery Receipt Slip",-1),ne={class:"q-pt-md"};function me(e,r,s,v,c,m){const o=q("q-row"),b=q("AddDeliveryReceiptQuantityRemarksDialog");return k(),D(I,{class:"q-pa-sm"},{default:t(()=>[i(A,{modelValue:e.deliveryreceiptdialog,"onUpdate:modelValue":r[1]||(r[1]=p=>e.deliveryreceiptdialog=p),persistent:"",maximized:""},{default:t(()=>[i(N,null,{default:t(()=>[i(_,null,{default:t(()=>[de]),_:1}),i(g),i(_,{class:"scroll"},{default:t(()=>[i(o,{class:"q-gutter-xs"},{default:t(()=>[i(w,{"use-input":"","hide-selected":"",filled:"","fill-input":"","map-options":"","emit-value":"","input-debounce":"0",clearable:"",modelValue:e.deliverystore.rssearchnumber,"onUpdate:modelValue":[r[0]||(r[0]=p=>e.deliverystore.rssearchnumber=p),e.updateDeliveryModel],label:"Requisition Slip Number",options:e.requisitionstore.rsNumberOptions,loading:e.requisitionstore.requisitionsearchrsnumberloading,onFilter:e.filterRsNumber,onClear:e.clearDeliverySearchTable},{"no-option":t(()=>[i(x,null,{default:t(()=>[i(ee,{class:"text-grey"},{default:t(()=>[f(" No results ")]),_:1})]),_:1})]),prepend:t(()=>[i(y,{name:"search"})]),_:1},8,["modelValue","options","loading","onFilter","onUpdate:modelValue","onClear"])]),_:1})]),_:1}),i(_,null,{default:t(()=>[i(o,null,{default:t(()=>[d("div",ne,[i(O,{title:"Requisition Items Search Results",columns:e.deliveryreceiptsearchcolumns,rows:e.requisitionstore.requisitiondetailsitems,loading:e.deliveryreceiptsearchtableloading,separator:"vertical","row-key":"rs_number_id","auto-width":"",flat:"",bordered:"",onRowClick:e.onRowClick},null,8,["columns","rows","loading","onRowClick"])])]),_:1})]),_:1}),i(g),i(S,{align:"left"},{default:t(()=>[i(n,{outline:"",label:"Close",color:"red",onClick:e.closeDialog},null,8,["onClick"]),i(n,{outline:"",label:"Add",color:"blue",onClick:e.addItems},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(b)]),_:1})}var pe=V(ae,[["render",me]]);const ue=C({name:"addremarks",setup(){return{deliverystore:$(),remarks:u("")}},methods:{save(){this.deliverystore.addRemarksToItems(this.remarks),this.remarks=u(""),this.deliverystore.closeAddRemarksDialog()},close(){this.deliverystore.closeAddRemarksDialog(),this.remarks=u("")}}}),ce=d("h6",null,"Add Remarks",-1),ye={class:"row items-center"},ve={class:"col q-pa-sm"};function be(e,r,s,v,c,m){return k(),D(I,{class:"q-pa-sm"},{default:t(()=>[i(A,{modelValue:e.deliverystore.addremarksdialog,"onUpdate:modelValue":r[1]||(r[1]=o=>e.deliverystore.addremarksdialog=o),"backdrop-filter":"blur(4px)",persistent:""},{default:t(()=>[i(N,{style:{width:"700px","max-width":"80vw"}},{default:t(()=>[i(_,null,{default:t(()=>[ce]),_:1}),i(g),i(_,{class:"scroll"},{default:t(()=>[d("div",ye,[d("div",ve,[i(R,{label:"Remarks",modelValue:e.remarks,"onUpdate:modelValue":r[0]||(r[0]=o=>e.remarks=o),filled:""},{prepend:t(()=>[i(y,{name:"123"})]),_:1},8,["modelValue"])])])]),_:1}),i(g),i(S,{align:"left"},{default:t(()=>[i(n,{outline:"",label:"Close",color:"red",onClick:e.close},null,8,["onClick"]),i(n,{outline:"",label:"Save",color:"blue",onClick:e.save},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","backdrop-filter"])]),_:1})}var fe=V(ue,[["render",be]]);const _e=C({name:"deliveryreciept",setup(){const e=K(),r=e[L().type.name],s=$(),v=X(),c=B(),m=Y(),o=Z(),b=a(()=>s.deliveryreceiptpayload),p=a(()=>s.tablecreatecolumns),l=a(()=>o.preparedByOptions),Q=a(()=>m.approverOptions),F=a(()=>m.usersOptions),H=a(()=>s.delivery_receipt_item),M=a(()=>c.requisitionsearchrsnumberloading),P=a({get:()=>s.selected,set:T=>s.selected=T});return{formheaders:e,formHeader:r,deliverystore:s,locationstore:v,requisitionstore:c,userstore:m,loginstore:o,deliveryreceiptpayload:b,tablecreatecolumns:p,preparedByOptions:l,approverOptions:Q,usersOptions:F,delivery_receipt_item:H,requisitionsearchrsnumberloading:M,selected:P,rsnumberoptions:u([])}},methods:{filterRsNumber(e,r,s){r(()=>{e===""?this.rsnumberoptions=u([]):this.deliverystore.searchDeliveryRsOrItem(e)})},updateRsNumberModel(e){this.delivery_receipt_item.rs_number_label=e;let r=this.requisitionstore.rsnumbersearchresults.find(s=>s.id===e);this.deliverystore.delivery_receipt_item.rs_number_label=r.rs_number}},components:{FormHeaderVue:W,AddDeliveryReceiptDialog:pe,AddRemarksDialog:fe}}),he={class:"row items-center"},ke={class:"col q-pa-sm"},ge={class:"col q-pa-sm"},qe={class:"col q-pa-sm"},De={class:"row items-center justify-end"},Re={class:"q-pt-md"},Ce={class:"row items-center"},Ve={class:"col q-pa-sm"};function $e(e,r,s,v,c,m){const o=q("form-header-vue"),b=q("AddDeliveryReceiptDialog"),p=q("AddRemarksDialog");return k(),D(I,{class:"q-pa-sm"},{default:t(()=>[i(o,{headers:e.formHeader.headers,name:`Create ${e.formHeader.name}`},null,8,["headers","name"]),d("div",he,[d("div",ke,[i(R,{modelValue:e.deliveryreceiptpayload.invoice_number,"onUpdate:modelValue":r[0]||(r[0]=l=>e.deliveryreceiptpayload.invoice_number=l),label:"Delivery Receipt/Invoice Number"},{prepend:t(()=>[i(y,{name:"123",color:"black"})]),_:1},8,["modelValue"])]),d("div",ge,[i(w,{label:"Delivered To",options:e.locationstore.locationOptions,"map-options":"","emit-value":"",modelValue:e.deliveryreceiptpayload.address,"onUpdate:modelValue":r[1]||(r[1]=l=>e.deliveryreceiptpayload.address=l)},{prepend:t(()=>[i(y,{name:"map",color:"black"})]),_:1},8,["options","modelValue"])]),d("div",qe,[i(R,{class:"fit",modelValue:e.deliveryreceiptpayload.date,"onUpdate:modelValue":r[3]||(r[3]=l=>e.deliveryreceiptpayload.date=l),label:"Date"},{prepend:t(()=>[i(y,{name:"event",class:"cursor-pointer",color:"black"},{default:t(()=>[i(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[i(E,{modelValue:e.deliveryreceiptpayload.date,"onUpdate:modelValue":r[2]||(r[2]=l=>e.deliveryreceiptpayload.date=l),mask:e.deliverystore.dateFormat,"today-btn":""},{default:t(()=>[d("div",De,[j(i(n,{label:"Close",color:"primary",flat:""},null,512),[[J]])])]),_:1},8,["modelValue","mask"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),d("div",Re,[i(O,{title:"Items List","loading-label":"Gimme a sec and I'll fetch ya data!",rows:e.deliveryreceiptpayload.delivery_receipt_items,columns:e.tablecreatecolumns,selection:"single",selected:e.selected,"onUpdate:selected":r[10]||(r[10]=l=>e.selected=l),"row-key":"rs_number",separator:"vertical","auto-width":"",flat:"",bordered:""},{"top-right":t(()=>[i(n,{class:"q-mr-sm",color:"primary",icon:"add",onClick:r[4]||(r[4]=l=>e.deliverystore.openAddDeliveryDialog())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Add Item")]),_:1})]),_:1}),e.deliverystore.hasSelection?(k(),D(n,{key:0,class:"q-mr-sm",color:"primary",icon:"remove",onClick:r[5]||(r[5]=l=>e.deliverystore.removeItem())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Remove Item")]),_:1})]),_:1})):U("",!0),i(n,{class:"q-mr-sm",color:"primary",icon:"confirmation_number",onClick:r[6]||(r[6]=l=>e.deliverystore.generateDeliveryNumber())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Generate Delivery Number")]),_:1})]),_:1}),e.deliverystore.hasSelection?(k(),D(n,{key:1,class:"q-mr-sm",color:"primary",icon:"description",onClick:r[7]||(r[7]=l=>e.deliverystore.openAddRemarksDialog())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Add Remarks")]),_:1})]),_:1})):U("",!0),i(n,{class:"q-mr-sm",color:"primary",icon:"restart_alt",onClick:r[8]||(r[8]=l=>e.deliverystore.resetCreateItem())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Reset")]),_:1})]),_:1}),i(n,{class:"q-mr-sm",color:"primary",loading:e.deliverystore.postdeliveryreceiptitemloading,icon:"save",onClick:r[9]||(r[9]=l=>e.deliverystore.postItem())},{default:t(()=>[i(h,{class:"bg-accent"},{default:t(()=>[f("Save")]),_:1})]),_:1},8,["loading"])]),_:1},8,["rows","columns","selected"])]),d("div",Ce,[d("div",Ve,[i(w,{label:"Prepared By",options:e.preparedByOptions,"map-options":"","emit-value":"",modelValue:e.deliveryreceiptpayload.prepared_by,"onUpdate:modelValue":r[11]||(r[11]=l=>e.deliveryreceiptpayload.prepared_by=l)},{prepend:t(()=>[i(y,{name:"fact_check",color:"black"})]),_:1},8,["options","modelValue"])])]),i(b),i(p)]),_:1})}var ar=V(_e,[["render",$e]]);export{ar as default};
