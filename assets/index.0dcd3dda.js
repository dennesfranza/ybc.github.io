import{aU as t,af as p}from"./index.834e57e7.js";import{b as d}from"./axios.473f2f39.js";var s={dateFormat:"YYYY-MM-DD",tableindexcolumns:[{name:"ws_number",label:"WS Number",field:"ws_number",align:"left"},{name:"date",label:"Date",field:"date",align:"left"},{name:"location",label:"Location",field:a=>a.location.name,align:"left"},{name:"requested_by",label:"Requested By",field:a=>a.requested_by.name,align:"left"},{name:"status",label:"Status",field:"status",align:"left"}],tableindexrows:[],tablecreatecolumns:[{name:"description_label",label:"Description",field:"description_label",align:"left"},{name:"quantity",label:"Quantity",field:"quantity",align:"left"},{name:"purpose",label:"Purpose",field:"purpose",align:"left"}],tablecreaterows:[],createwithdrawalitem:{ws_number:"",date:"",location:null,requested_by:null,noted_by:null,issued_by:null,withdrawal_slip_items:[]},createwithdrawalitems:{description:null,description_label:"",quantity:0,purpose:""},tableindexloading:!1,withdrawalslipdetailsdialog:!1,withdrawalslipdetailsloadingpage:!1,withdrawalslipdetails:{location:null,requested_by:null,noted_by:null,issued_by:null,ws_number:null,date:null},withdrawalslipdetailsitems:[],withdrawalslipdetailscolumns:[{name:"description",label:"Description",field:a=>a.description.name,align:"left"},{name:"quantity",label:"Quantity",field:"quantity",align:"left"},{name:"purpose",label:"Purpose",field:"purpose",align:"left"}],postwithdrawalslipitemloading:!1,addwithdrawalslipitemdialog:!1,withdrawalslipdetailsinput:[{name:"quantity",label:"Quantity",icon:"123",type:"input"},{name:"description",label:"Description",icon:"search",type:"select"},{name:"purpose",label:"Purpose",icon:"sunny",type:"input"}],selected:[],withdrawalslipapprovalloading:!1,withdrawalslipdisapprovalloading:!1};const u=a=>{a.tableindexloading=!0,d.get("withdrawalslip/").then(i=>{i.status===200&&(a.tableindexrows=i.data)}).catch(i=>{t.create({timeout:1500,position:"center",color:"red",message:`Error: ${JSON.stringify(i.response.data)}`})}).finally(()=>{setTimeout(()=>{a.tableindexloading=!1},500)})},c=a=>{a.withdrawalslipdetailsdialog=!0,a.withdrawalslipdetailsloadingpage=!0},h=a=>{a.withdrawalslipdetailsdialog=!1,a.withdrawalslipdetails={location:null,requested_by:null,noted_by:null,issued_by:null,ws_number:null,date:null},a.withdrawalslipdetailsitems=[]},m=(a,i)=>{d.get(`withdrawalslip/${i}/`).then(e=>{e.status===200&&(a.withdrawalslipdetails.location=e.data.location.name,a.withdrawalslipdetails.requested_by=e.data.requested_by.name,a.withdrawalslipdetails.noted_by=e.data.noted_by===null?e.data.noted_by.name:"",a.withdrawalslipdetails.issued_by=e.data.issued_by===null?e.data.issued_by.name:"",a.withdrawalslipdetails.ws_number=e.data.ws_number,a.withdrawalslipdetails.date=e.data.date,a.withdrawalslipdetailsitems=e.data.withdrawal_slip_items)}).catch(e=>{t.create({timeout:1500,position:"center",color:"red",message:`Error: ${JSON.stringify(e.response.data)}`})}).finally(()=>{setTimeout(()=>{a.withdrawalslipdetailsloadingpage=!1},500)})},b=(a,i)=>{a.postwithdrawalslipitemloading=!0,d.post("withdrawalslip/",i).then(e=>{e.status===200&&t.create({timeout:1500,position:"center",color:"primary",message:"Withdrawal Slip Saved"})}).catch(e=>{t.create({timeout:1500,position:"center",color:"red",message:`Error: ${JSON.stringify(e.response.data)}`})}).finally(()=>{setTimeout(()=>{a.postwithdrawalslipitemloading=!1,a.createwithdrawalitem={ws_number:"",date:"",location:null,requested_by:null,noted_by:null,issued_by:null,withdrawal_slip_items:[]},a.router.push({path:"/WithdrawalSlip"})},500)})},f=a=>{a.addwithdrawalslipitemdialog=!0},r=a=>{a.addwithdrawalslipitemdialog=!1},g=a=>{let i=a.createwithdrawalitems;a.createwithdrawalitem.withdrawal_slip_items.push(i)},n=a=>{a.createwithdrawalitems={description:null,description_label:"",quantity:0,purpose:""}},_=(a,i)=>{let e=a.createwithdrawalitem.withdrawal_slip_items.findIndex(l=>l.description===i.description);a.createwithdrawalitem.withdrawal_slip_items.splice(e,1)},o=(a,i)=>{d.put(`withdrawalslip-approval/${i.id}/`,i).then(e=>{if(e.status===200){let l=a.tableindexrows.findIndex(w=>w.id===e.data.id);a.tableindexrows[l].is_approved=e.data.is_approved,a.tableindexrows[l].status=e.data.status,a.tableindexrows[l].noted_by=e.data.noted_by}t.create({timeout:1500,position:"center",color:"primary",message:"Approval Sent"})}).catch(e=>{t.create({timeout:1500,position:"center",color:"red",message:`Error: ${JSON.stringify(e.response.data)}`})}).finally(()=>{setTimeout(()=>{a.withdrawalslipapprovalloading=!1,a.withdrawalslipdisapprovalloading=!1,a.selected=[]},500)})},v=p("withdrawalslip",{state:()=>s,getters:{hasSelection:a=>a.selected.length>0},actions:{getAllItems(){u(this)},openDetailsDialog(){c(this)},closeDetailsDialog(){h(this)},retrieveWithdrawalItem(a){m(this,a)},postWithdrawalItem(a){b(this,a)},openAddWithdrawalSlipDialog(){f(this)},closeAddWithdrawalSlipDialog(){r(this),n(this)},addWithdrawalItem(){g(this),r(this),n(this)},removeWithdrawalItem(a){_(this,a)},approveRequest(a){s.withdrawalslipapprovalloading=!0,o(this,a)},disapproveRequest(a){s.withdrawalslipdisapprovalloading=!0,o(this,a)}}});export{v as u};
