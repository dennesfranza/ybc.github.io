import{Q as N}from"./QInnerLoading.fed03f99.js";import{af as L,d as $,c,_ as Q,C as n,G as s,H as a,f as i,D as g,E as A,F as U,N as p,J as u,Q as _,O as m,M as w,x as P,o as B,K as k}from"./index.7c7b8282.js";import{Q as b}from"./QInput.321b8eed.js";import{Q as D}from"./QTooltip.574840fb.js";import{e as I,f as F,Q as T}from"./QTable.a5502490.js";import{Q as C}from"./QPage.9773e727.js";import{b as q}from"./axios.56601fbe.js";import{Q as y}from"./QCardSection.7cfc943c.js";import{Q as V}from"./QSeparator.7443f346.js";import{Q as R}from"./QImg.3c8f2aa3.js";import{Q as x}from"./QCardActions.3b0fd6c6.js";import{Q as M}from"./QCard.fd6c76dc.js";import{Q as O,a as Y}from"./QPopupProxy.db37d52e.js";import{Q as E}from"./QFile.65bfc324.js";import{C as j}from"./ClosePopup.c5e1e30c.js";import{u as G}from"./index.e2cb4afa.js";import"./use-dark.f1ed3aaa.js";import"./format.65a6df85.js";import"./use-id.52264d24.js";import"./uid.42677368.js";import"./use-key-composition.a804c2f6.js";import"./use-form.8f60a875.js";import"./QList.51621a8d.js";import"./rtl.b51694b1.js";import"./QItem.09a728d7.js";import"./QItemLabel.b8289c17.js";import"./QCheckbox.8583a2e3.js";import"./use-cache.b0833c75.js";import"./date.f405f89b.js";var H={dateFormat:"YYYY-MM-DD",vehicledefaultdetails:{mv_file_number:"",series:"",make:"",vehicle_model:"",body_type:"",plate_number:"",engine_number:"",chassis_number:"",year_model:"",or_date:"",cr_number:"",vehicle_registration_date:"",vehicle_registration_expiry_date:"",location:"",image:""},createvehicleitem:{mv_file_number:"",series:"",make:"",vehicle_model:"",body_type:"",plate_number:"",engine_number:"",chassis_number:"",year_model:"",or_date:"",cr_number:"",vehicle_registration_date:"",vehicle_registration_expiry_date:"",location:"",image:"",imageurl:""},vehicledetailsinput:[{name:"mv_file_number",label:"MV File Number",icon:"123",type:"input"},{name:"series",label:"Series",icon:"light",type:"input"},{name:"make",label:"Make",icon:"factory",type:"input"},{name:"vehicle_model",label:"Model",icon:"pallet",type:"input"},{name:"body_type",label:"Body Type",icon:"directions_car",type:"input"},{name:"plate_number",label:"Plate Number",icon:"local_parking",type:"input"},{name:"engine_number",label:"Engine Number",icon:"garage",type:"input"},{name:"chassis_number",label:"Chassis Number",icon:"local_taxi",type:"input"},{name:"year_model",label:"Year Model",icon:"verified",type:"input"},{name:"or_date",label:"OR Date",icon:"calendar_month",type:"date"},{name:"cr_number",label:"CR Number",icon:"tag",type:"input"},{name:"vehicle_registration_date",label:"Vehicle Registration Date",icon:"calendar_month",type:"date"},{name:"vehicle_registration_expiry_date",label:"Registration Expiry Date",icon:"calendar_month",type:"date"},{name:"location",label:"Location",icon:"map",type:"input"},{name:"image",label:"Image",icon:"calendar_month",type:"file"}],tableindexcolumns:[{name:"vehicle_model",label:"Vehicle Model",field:"vehicle_model",align:"left"},{name:"body_type",label:"Body Type",field:"body_type",align:"left"},{name:"plate_number",label:"Plate Number",field:"plate_number",align:"left"},{name:"year_model",label:"Year Model",field:"year_model",align:"left"},{name:"status",label:"Status",field:"status",align:"left"},{name:"location",label:"Project Site",field:e=>e.location.name,align:"left"}],tableindexrows:[],vehicleindextableloading:!1,vehicleadditemdialog:!1,vehicleadditemloading:!1,vehicleremoveitemdialog:!1,vehicleremoveitemloading:!1,vehicleupdateitemdialog:!1,vehicleupdateitemloading:!1,vehicledetailsdialog:!1,selected:[]};const J=e=>{e.vehicleindextableloading=!0,q.get("vehicle/").then(l=>{l.status===200&&(console.log(l),e.tableindexrows=l.data.results)}).catch(l=>{console.log(l)}).finally(()=>{setTimeout(()=>{e.vehicleindextableloading=!1},1500)})},K=(e,l)=>{e.vehicledetailsdialog=!0,e.vehicledefaultdetails.mv_file_number=l.mv_file_number,e.vehicledefaultdetails.series=l.series,e.vehicledefaultdetails.maker=l.maker,e.vehicledefaultdetails.vehicle_model=l.vehicle_model,e.vehicledefaultdetails.body_type=l.body_type,e.vehicledefaultdetails.plate_number=l.plate_number,e.vehicledefaultdetails.engine_number=l.engine_number,e.vehicledefaultdetails.chassis_number=l.chassis_number,e.vehicledefaultdetails.year_model=l.year_model,e.vehicledefaultdetails.or_date=l.or_date,e.vehicledefaultdetails.cr_number=l.cr_number,e.vehicledefaultdetails.vehicle_registration_date=l.vehicle_registration_date,e.vehicledefaultdetails.vehicle_registration_expiry_date=l.vehicle_registration_expiry_date,e.vehicledefaultdetails.location=l.location.name,e.vehicledefaultdetails.image=l.image},z=e=>{e.vehicledetailsdialog=!1,e.vehicledefaultdetails={mv_file_number:"",series:"",maker:"",vehicle_model:"",body_type:"",plate_number:"",engine_number:"",chassis_number:"",year_model:"",or_date:"",cr_number:"",vehicle_registration_date:"",vehicle_registration_expiry_date:"",location:"",image:""}},W=e=>{e.vehicleadditemdialog=!0},X=e=>{e.vehicleadditemdialog=!1,e.createvehicleitem={mv_file_number:"",series:"",make:"",vehicle_model:"",body_type:"",plate_number:"",engine_number:"",chassis_number:"",year_model:"",or_date:"",cr_number:"",vehicle_registration_date:"",vehicle_registration_expiry_date:"",location:"",image:"",imageurl:""}},Z=e=>{e.vehicleadditemloading=!0;let l=new FormData;l.append("mv_file_number",e.createvehicleitem.mv_file_number),l.append("series",e.createvehicleitem.series),l.append("make",e.createvehicleitem.make),l.append("vehicle_model",e.createvehicleitem.vehicle_model),l.append("body_type",e.createvehicleitem.body_type),l.append("plate_number",e.createvehicleitem.plate_number),l.append("engine_number",e.createvehicleitem.engine_number),l.append("chassis_number",e.createvehicleitem.chassis_number),l.append("year_model",e.createvehicleitem.year_model),l.append("or_date",e.createvehicleitem.or_date),l.append("cr_number",e.createvehicleitem.cr_number),l.append("vehicle_registration_date",e.createvehicleitem.vehicle_registration_date),l.append("vehicle_registration_expiry_date",e.createvehicleitem.vehicle_registration_expiry_date),l.append("location",e.createvehicleitem.location),l.append("image",e.createvehicleitem.image),q.post("vehicle/",l).then(r=>{r.status===201&&(console.log(r),e.tableindexrows.unshift(r.data))}).catch(r=>{console.log(r)}).finally(()=>{setTimeout(()=>{e.vehicleadditemloading=!1,e.vehicleadditemdialog=!1,e.createvehicleitem={mv_file_number:"",series:"",make:"",vehicle_model:"",body_type:"",plate_number:"",engine_number:"",chassis_number:"",year_model:"",or_date:"",cr_number:"",vehicle_registration_date:"",vehicle_registration_expiry_date:"",location:"",image:"",imageurl:""}},1500)})},S=L("vehicleStore",{state:()=>H,getters:{hasSelection:e=>e.selected.length>0},actions:{getAllVehicles(){J(this)},openVehicleDetailsDialog(e){K(this,e)},closeVehicleDetailsDialog(){z(this)},openAddVehicleDialog(){W(this)},closeAddVehicleDialog(){X(this)},postVehicleItem(){Z(this)}}}),ee=$({name:"vehicledetails",setup(){const e=S(),l=c(()=>e.vehicledetailsdialog),r=c(()=>e.vehicledetailsinput),h=c(()=>e.vehicledefaultdetails);return{vehiclestore:e,vehicledetailsdialog:l,vehicledetailsinput:r,vehicledefaultdetails:h}}}),le=u("h6",null,"Vehicle Details",-1),ie={class:"col q-pa-sm"};function ae(e,l,r,h,v,f){return n(),s(C,{class:"q-pa-sm"},{default:a(()=>[i(I,{modelValue:e.vehicledetailsdialog,"onUpdate:modelValue":l[1]||(l[1]=d=>e.vehicledetailsdialog=d),"backdrop-filter":"blur(4px)",persistent:""},{default:a(()=>[i(M,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[i(y,null,{default:a(()=>[le]),_:1}),i(V),i(y,{class:"scroll"},{default:a(()=>[(n(!0),g(U,null,A(e.vehicledetailsinput,d=>(n(),g("div",{class:"row items-center",key:d.key},[u("div",ie,[d.name!="image"?(n(),s(b,{key:0,label:d.label,readonly:"",modelValue:e.vehicledefaultdetails[d.name],"onUpdate:modelValue":t=>e.vehicledefaultdetails[d.name]=t},{prepend:a(()=>[i(_,{name:d.icon},null,8,["name"])]),_:2},1032,["label","modelValue","onUpdate:modelValue"])):m("",!0),d.name==="image"?(n(),s(R,{key:1,src:e.vehicledefaultdetails[d.name],"spinner-color":"white",style:{height:"140px","max-width":"150px"}},null,8,["src"])):m("",!0)])]))),128))]),_:1}),i(V),i(x,{align:"left"},{default:a(()=>[i(p,{outline:"",label:"Close",color:"red",onClick:l[0]||(l[0]=d=>e.vehiclestore.closeVehicleDetailsDialog())})]),_:1})]),_:1})]),_:1},8,["modelValue","backdrop-filter"])]),_:1})}var te=Q(ee,[["render",ae]]);const oe=$({name:"addvehicle",setup(){const e=S(),l=G(),r=c(()=>e.vehicleadditemdialog),h=c(()=>e.createvehicleitem),v=c(()=>e.vehicledetailsinput);return{vehiclestore:e,locationstore:l,vehicleadditemdialog:r,createvehicleitem:h,vehicledetailsinput:v}},methods:{onSelected(){this.createvehicleitem.image!=null?this.createvehicleitem.imageurl=window.URL.createObjectURL(this.createvehicleitem.image):this.createvehicleitem.imageurl=null}}}),ne=u("h6",null,"Add Vehicle",-1),re={class:"row items-center justify-end"},de={class:"row items-center"},se={class:"col q-pa-sm"};function ce(e,l,r,h,v,f){const d=w("q-row");return n(),s(C,{class:"q-pa-sm"},{default:a(()=>[i(I,{modelValue:e.vehicleadditemdialog,"onUpdate:modelValue":l[5]||(l[5]=t=>e.vehicleadditemdialog=t),persistent:"","backdrop-filter":"blur(4px)"},{default:a(()=>[i(M,{style:{width:"700px","max-width":"80vw"}},{default:a(()=>[i(y,null,{default:a(()=>[ne]),_:1}),i(V),i(y,{class:"scroll"},{default:a(()=>[(n(!0),g(U,null,A(e.vehicledetailsinput,t=>(n(),s(d,{class:"q-gutter-xs",key:t.name},{default:a(()=>[t.type==="input"&&t.name!="location"?(n(),s(b,{key:0,filled:"",label:t.label,modelValue:e.createvehicleitem[t.name],"onUpdate:modelValue":o=>e.createvehicleitem[t.name]=o},{prepend:a(()=>[i(_,{name:t.icon,color:"black"},null,8,["name"])]),_:2},1032,["label","modelValue","onUpdate:modelValue"])):m("",!0),t.type==="date"?(n(),s(b,{key:1,class:"fit",filled:"",modelValue:e.createvehicleitem[t.name],"onUpdate:modelValue":o=>e.createvehicleitem[t.name]=o,label:t.label},{prepend:a(()=>[i(_,{name:t.icon,color:"black",class:"cursor-pointer"},{default:a(()=>[i(O,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[i(Y,{modelValue:e.createvehicleitem[t.name],"onUpdate:modelValue":o=>e.createvehicleitem[t.name]=o,mask:e.vehiclestore.dateFormat,"today-btn":""},{default:a(()=>[u("div",re,[P(i(p,{label:"Close",color:"primary",flat:""},null,512),[[j]])])]),_:2},1032,["modelValue","onUpdate:modelValue","mask"])]),_:2},1024)]),_:2},1032,["name"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):m("",!0),t.name==="location"?(n(),s(F,{key:2,label:"Location",options:e.locationstore.locationOptions,"map-options":"","emit-value":"",class:"fit",filled:"",modelValue:e.createvehicleitem.location,"onUpdate:modelValue":l[0]||(l[0]=o=>e.createvehicleitem.location=o)},{prepend:a(()=>[i(_,{name:"map",color:"black"})]),_:1},8,["options","modelValue"])):m("",!0),t.type==="file"?(n(),s(E,{key:3,modelValue:e.createvehicleitem.image,"onUpdate:modelValue":[l[1]||(l[1]=o=>e.createvehicleitem.image=o),l[2]||(l[2]=o=>e.onSelected())],label:"Image",clearable:"",filled:""},{prepend:a(()=>[i(_,{name:"attach_file"})]),_:1},8,["modelValue"])):m("",!0)]),_:2},1024))),128)),u("div",de,[u("div",se,[i(R,{src:e.createvehicleitem.imageurl,"spinner-color":"black",style:{height:"140px","max-width":"150px"}},null,8,["src"])])])]),_:1}),i(V),i(x,{align:"left"},{default:a(()=>[i(p,{outline:"",label:"Close",color:"red",onClick:l[3]||(l[3]=t=>e.vehiclestore.closeAddVehicleDialog())}),i(p,{outline:"",label:"Save",color:"blue",loading:e.vehiclestore.vehicleadditemloading,onClick:l[4]||(l[4]=t=>e.vehiclestore.postVehicleItem())},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","backdrop-filter"])]),_:1})}var me=Q(oe,[["render",ce]]);const ue=$({name:"vehiclemanagement",setup(){const e=S(),l=c(()=>e.tableindexcolumns),r=c(()=>e.tableindexrows),h=c({get:()=>e.selected,set:f=>e.selected=f}),v=c(()=>e.hasSelection);return B(()=>e.getAllVehicles()),{vehiclestore:e,tableindexcolumns:l,tableindexrows:r,selected:h,hasSelection:v}},methods:{onRowClick(e,l,r){console.log(l),this.vehiclestore.openVehicleDetailsDialog(l)},clickRemoveItem(){console.log(this.selected[0])}},components:{VehicleDetailsDialog:te,AddVehicleDialog:me}}),he={class:"row items-center"},pe={class:"col items-center"},ve={class:"row"},_e={key:0},ge={key:1};function fe(e,l,r,h,v,f){const d=w("VehicleDetailsDialog"),t=w("AddVehicleDialog");return n(),s(C,{class:"q-pa-sm"},{default:a(()=>[u("div",he,[u("div",pe,[u("div",ve,[e.$q.platform.is.desktop?(n(),g("h2",_e,"Vehicle Management")):m("",!0),e.$q.platform.is.mobile?(n(),g("h6",ge,"Vehicle Management")):m("",!0)])])]),i(T,{title:"Vehicle List","auto-width":"",flat:"",bordered:"",selection:"single",selected:e.selected,"onUpdate:selected":l[4]||(l[4]=o=>e.selected=o),columns:e.tableindexcolumns,rows:e.tableindexrows,separator:"vertical",filter:e.indextablefilter,loading:e.vehiclestore.vehicleindextableloading,onRowClick:e.onRowClick},{loading:a(()=>[i(N,{showing:"",color:"primary"})]),"top-right":a(()=>[i(b,{class:"q-mr-sm",dense:"",debounce:"500",modelValue:e.indextablefilter,"onUpdate:modelValue":l[0]||(l[0]=o=>e.indextablefilter=o),placeholder:"Search",outlined:""},{append:a(()=>[i(_,{name:"search"})]),_:1},8,["modelValue"]),i(p,{class:"q-mr-sm",color:"primary",icon:"add",onClick:l[1]||(l[1]=o=>e.vehiclestore.openAddVehicleDialog())},{default:a(()=>[i(D,{class:"bg-accent"},{default:a(()=>[k("Add Item")]),_:1})]),_:1}),e.hasSelection?(n(),s(p,{key:0,class:"q-mr-sm",color:"primary",icon:"remove",onClick:l[2]||(l[2]=o=>e.clickRemoveItem())},{default:a(()=>[i(D,{class:"bg-accent"},{default:a(()=>[k("Remove Item")]),_:1})]),_:1})):m("",!0),i(p,{class:"q-mr-sm",color:"primary",icon:"sync",onClick:l[3]||(l[3]=o=>e.vehiclestore.getAllVehicles())},{default:a(()=>[i(D,{class:"bg-accent"},{default:a(()=>[k("Get Latest Data")]),_:1})]),_:1})]),_:1},8,["selected","columns","rows","filter","loading","onRowClick"]),i(d),i(t)]),_:1})}var Je=Q(ue,[["render",fe]]);export{Je as default};
